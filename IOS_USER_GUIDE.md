# iOS 设备连接指南

## 为什么 iOS 无法自动发现设备？

由于 Apple 的隐私和安全限制，iOS Safari 浏览器**无法**主动扫描局域网设备。这是系统级别的限制，所有基于浏览器的应用都面临同样的问题。

## 正确的连接方式

### 方法 1：扫描二维码（推荐）

1. **在桌面端**：
   - 打开 Airdrop 应用
   - 点击右上角的"扫码连接"按钮
   - 会显示一个二维码

2. **在 iOS 设备上**：
   - 打开相机 App 或微信扫一扫
   - 扫描桌面端显示的二维码
   - 点击弹出的通知，会自动打开浏览器并连接

3. **连接成功**：
   - iOS 设备会自动连接到桌面端
   - 可以看到桌面端设备出现在设备列表中
   - 现在可以互相传输文件和文本了

### 方法 2：手动输入地址

如果无法扫描二维码，可以手动输入地址：

1. **在桌面端**：
   - 点击"扫码连接"按钮
   - 查看显示的地址（例如：`http://192.168.1.100:8080`）

2. **在 iOS Safari 中**：
   - 打开 Safari 浏览器
   - 在地址栏输入桌面端显示的地址
   - 按回车访问

3. **连接成功**：
   - 页面加载后会自动连接
   - 可以看到桌面端设备

## 常见问题

### Q: 为什么设备列表是空的？

**A:** iOS 浏览器无法主动发现设备，这是正常的。请按照上述方法扫描二维码或手动输入地址连接。

### Q: 扫码后无法连接？

**A:** 请检查：
1. iOS 设备和桌面端是否在同一 WiFi 网络
2. 桌面端防火墙是否允许端口 8080
3. 尝试关闭 VPN 或代理

### Q: 连接后设备列表仍然是空的？

**A:** 这可能是时序问题，请尝试：
1. 刷新页面（下拉刷新）
2. 等待 5-10 秒，应用会自动刷新设备列表
3. 检查桌面端应用是否正常运行

### Q: 可以跨网络传输吗？

**A:** 目前只支持局域网传输。如果需要跨网络传输，可以考虑：
1. 使用 VPN 将两个设备连接到同一虚拟网络
2. 等待未来版本的 WebRTC P2P 支持

### Q: 为什么 Android 可以自动发现，iOS 不行？

**A:** Android 浏览器的权限更开放，但 iOS Safari 出于安全考虑限制了本地网络访问。这是 Apple 的设计决策，不是应用的问题。

## 技术说明

### 为什么不能像 AirDrop 一样？

Apple 的 AirDrop 是**原生应用**，可以申请系统级权限：
- 使用 Bluetooth 发现附近设备
- 使用 WiFi Direct 进行 P2P 传输
- 访问本地网络扫描 API

而**浏览器应用**受到严格限制：
- 无法访问 Bluetooth API（iOS 限制）
- 无法进行 UDP 广播
- 无法使用 mDNS/Bonjour 发现

### 其他应用是怎么做的？

- **LocalSend**: 提供原生 iOS App，可以申请权限
- **Snapdrop**: 使用中继服务器，设备通过服务器发现彼此
- **ShareDrop**: 使用 Firebase 作为信令服务器

我们的应用选择了**最简单、最隐私**的方案：QR 码 + 直接连接，无需中继服务器。

## 未来计划

我们正在考虑以下改进：

1. ✅ **记住上次连接** - 下次打开自动连接
2. 🔄 **WebRTC P2P** - 支持跨网络传输
3. 🔄 **原生 iOS App** - 可以申请本地网络权限
4. 🔄 **NFC 连接** - 两台设备碰一碰即可连接

## 反馈

如果你有任何问题或建议，欢迎反馈！
